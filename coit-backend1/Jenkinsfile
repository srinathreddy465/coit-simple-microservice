pipeline{
    agent any
    stages{
        stage("Build"){
            steps{
                sh 'cd coit-backend1 && mvn install'
            }
        }
        
        stage("DockerBuildandpush"){
            steps{
                sh 'cd coit-backend1 && docker build -t coit-backend1 .'
                sh 'docker run -d -p 80:80 coit-backend1'
                  sleep 2
                 sh 'Container_ID=`docker ps | grep "coit-backend1" | awk '{print $1}'`'
                 sh 'docker stop $Container_ID'
                 sh 'docker rm $Container_ID'
            }
        }
       stage("Deploy"){
            steps{
                sh 'java -jar "sentiment-analysis-web-0.0.1.jar'
            }
        } 
        
    }
}
